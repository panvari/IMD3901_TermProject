<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
    <script src="./js/courtyardPositionTrigger.js"></script>
    <script src="./js/gem1Popups.js"></script>
    <script src="./js/spherical-env-map.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="https://rawgit.com/rdub80/aframe-gui/master/dist/aframe-gui.min.js"></script>
    <!--GUI Library-->
    <script src="https://unpkg.com/aframe-environment-component@1.1.0/dist/aframe-environment-component.min.js"></script>
    <!--Environment extension-->
    <title>Training Area</title>

</head>

<body>
    <a-scene physics="debug: false">

        <a-assets>
            <!-- Images -->
            <img id="gemImage" src="./assets/images/gem.png">
            <img id="sky" src="./assets/images/CloudySky.jpg">
            <img id="trainingGame" src="./assets/images/targetpractice_desktopInstructions.png">
            <img id="kingMessage" src="./assets/images/kingMessage_08.png">


            <!-- Models -->
            <a-asset-item id="turret" src="./assets/models/Turret.glb"></a-asset-item>
            <a-asset-item id="gem" src="./assets/models/gem.obj"></a-asset-item>
            <a-asset-item id="bridge" src="./assets/models/Drawbridge.glb"></a-asset-item>
            <a-asset-item id="innerGatehouse" src="./assets/models/InnerGatehouse.glb"></a-asset-item>
            <a-asset-item id="wall" src="./assets/models/Wall1.glb"></a-asset-item>
            <a-asset-item id="keep" src="./assets/models/Keep.glb"></a-asset-item>
            <a-asset-item id="pillar" src="./assets/models/pillar.glb"></a-asset-item>
            <a-asset-item id="well" src="./assets/models/well.glb"></a-asset-item>
            <a-asset-item id="trapDoor" src="./assets/models/shortTable.glb"></a-asset-item>
            <a-asset-item id="fence" src="./assets/models/fence.glb"></a-asset-item>
            <a-asset-item id="tower" src="./assets/models/RoofedTurret.glb"></a-asset-item>
            <a-asset-item id="door" src="./assets/models/door.glb"></a-asset-item>
            <a-asset-item id="dummy" src="./assets/models/trainingDummy.glb"></a-asset-item>
            <a-asset-item id="target" src="./assets/models/Target.glb"></a-asset-item>
            <a-asset-item id="shelf" src="./assets/models/shelf.glb"></a-asset-item>
            <a-asset-item id="sword" src="./assets/models/sword.glb"></a-asset-item>
            <a-asset-item id="spear" src="./assets/models/spear.glb"></a-asset-item>
            <a-asset-item id="mace" src="./assets/models/mace.glb"></a-asset-item>
            <a-asset-item id="bow" src="./assets/models/bow.glb"></a-asset-item>
            <a-asset-item id="arrow" src="./assets/models/arrow.glb"></a-asset-item>

        </a-assets>

        <a-entity environment="preset: threetowers; dressingAmount: 0"></a-entity>

        <!-- Lighting  -->
        <a-light type="ambient" position="5.579 25.204 -2.032" color="#222"></a-light>
        <a-light type="point" position="5.579 25.204 -2.032"></a-light>
        <a-light type="point" position="5.579 25.204 -10.032"></a-light>

        <a-entity id="cameraRig" player_position location movement-controls kinematic-body>
            <a-entity camera look-controls position="0 2.8 0" rotation="0 0 0">
                <a-cursor></a-cursor>

                <a-gui-label id="playerLocation" width="1.5" height="0.3" font-size="4rem" padding="1rem 2rem" position="3 1.8 -2.5" value="Training Area">
                </a-gui-label>

                <a-entity visible="false" id="kingMessage_08" position="2.2 -0.5 -2.5">
                    <a-image src="#kingMessage" width="4" height=" 1.3"></a-image>
                </a-entity>

                <a-entity visible="false" id="trainingInstructions" position="-2.2 -0.5 -2.5">
                    <a-image src="#trainingGame" width="4" height=" 3"></a-image>
                </a-entity>

                <a-image class="gem" id="gem1" src="#gemImage" width="0.3" height="0.5" position="-3.5 1.8 -2.5" opacity="0.4"></a-image>
                <a-image class="gem" id="gem2" src="#gemImage" width="0.3" height="0.5" position="-3.1 1.8 -2.5" opacity="0.4"></a-image>
                <a-image class="gem" id="gem3" src="#gemImage" width="0.3" height="0.5" position="-2.7 1.8 -2.5" opacity="0.4"></a-image>
                <a-image class="gem" id="gem4" src="#gemImage" width="0.3" height="0.5" position="-2.3 1.8 -2.5" opacity="0.4"></a-image>
                <a-image class="gem" id="gem5" src="#gemImage" width="0.3" height="0.5" position="-1.9 1.8 -2.5" opacity="0.4"></a-image>
                <a-image class="gem" id="gem6" src="#gemImage" width="0.3" height="0.5" position="-1.5 1.8 -2.5" opacity="0.4"></a-image>
            </a-entity>
        </a-entity>

        <!-- Gem -->
        <a-obj-model traininggem id="trainingGem" rotation="0 180 0" material="color: green" src="#gem" position="7 -1 -6" scale="0.1 0.1 0.1"></a-obj-model>

        <!-- Floor -->
        <a-plane static-body material="color: grey" width="1000" height="1000" rotation="-90 0 0" position="0 -0.2 -25"></a-plane>

        <a-gltf-model src="#keep" position="-40.943 0 35.415" scale="2 2.5 2" rotation="0 0 0"></a-gltf-model>
        <a-gltf-model src="#keep" position="-40.943 0 12.681" scale="2 2.5 2" rotation="0 0 0"></a-gltf-model>
        <a-gltf-model src="#keep" position="-40.943 0 -10.382" scale="2 2.5 2" rotation="0 0 0"></a-gltf-model>

        <a-entity onclick="changeScene('inner_courtyard')" gltf-model="#door" scale="1.4 1.4 1.4" position="0 0 2.2" rotation="0 180 0"></a-entity>

        <a-gltf-model id="walls" src="#wall" scale="0.5 0.8 1" position="15.373 0 3.253" rotation="0 0 0"></a-gltf-model>
        <a-gltf-model id="walls" src="#wall" scale="0.5 0.8 1" position="15.373 0 -21.612" rotation="0 0 0"></a-gltf-model>
        <a-gltf-model id="walls" src="#wall" scale="0.5 0.8 1" position="16.829 0 -23.091" rotation="0 90 0"></a-gltf-model>

        <a-gltf-model static-body material="color: grey" src="#turret" position="16.546 0 -21.612" scale="1 0.85 1"></a-gltf-model>
        <a-gltf-model static-body material="color: grey" src="#turret" position="16.546 0 3.253" scale="1 0.85 1"></a-gltf-model>

        <a-entity gltf-model="#tower" scale=" .01 .01 .01" position="23.045 0 25.327" rotation="0 0 0"></a-entity>

        <a-gltf-model id="fences" src="#fence" scale="1 1 1" position="10.499 -1.196 -14.389" rotation="0 0 0"></a-gltf-model>
        <a-gltf-model id="fences" src="#fence" scale="1 1 1" position="8.994 -1.196 -20.498" rotation="0 -90 0"></a-gltf-model>

        <a-gltf-model src="#dummy" scale=".8 .8 .8" position="8.132 -.950 -17.794" rotation="0 -24.835 0"></a-gltf-model>
        <a-gltf-model src="#dummy" scale=".8 .8 .8" position="10.242 -.950 -14.942" rotation="0 -47.434 0"></a-gltf-model>
        <a-gltf-model src="#dummy" scale=".8 .8 .8" position="13.594 -.950 -13.902" rotation="0 -63.167 0"></a-gltf-model>

        <a-gltf-model src="#target" scale=".5 .5 .5" position="15.410 0 -4.361" rotation="0 0 0"></a-gltf-model>
        <a-gltf-model src="#target" scale=".5 .5 .5" position="15.410 4.453 -4.361" rotation="0 0 0"></a-gltf-model>
        <a-gltf-model src="#target" scale=".5 .5 .5" position="3.454 0 -18.100" rotation="0 48.830 0"></a-gltf-model>

        <a-entity gltf-model="#shelf" scale="1 1 1" position="-9.989 -1.109 -3.426" rotation="0, 90, 0"></a-entity>
        <a-entity gltf-model="#shelf" scale="1 1 1" position="-9.989 -1.109 -10.353" rotation="0, 90, 0"></a-entity>
        <a-entity gltf-model="#shelf" scale="1 1 1" position="-9.989 -1.109 -17.159" rotation="0, 90, 0"></a-entity>

        <a-entity gltf-model="#sword" scale="1.325 1.325 1.325" position="-9.709 6.416 -1.278" rotation="0, 90, 180"></a-entity>
        <a-entity gltf-model="#sword" scale="1.325 1.325 1.325" position="-9.709 6.416 -2.388" rotation="0, 90, 180"></a-entity>
        <a-entity gltf-model="#sword" scale="1.325 1.325 1.325" position="-9.709 6.416 -3.426" rotation="0, 90, 180"></a-entity>
        <a-entity gltf-model="#sword" scale="1.325 1.325 1.325" position="-9.709 6.416 -4.567" rotation="0, 90, 180"></a-entity>
        <a-entity gltf-model="#sword" scale="1.325 1.325 1.325" position="-9.709 6.416 -5.577" rotation="0, 90, 180"></a-entity>

        <a-entity gltf-model="#spear" scale="1.091 1.091 1.091" position="-9.709 0.672 -8.178" rotation="0,  90, 0"></a-entity>
        <a-entity gltf-model="#spear" scale="1.091 1.091 1.091" position="-9.709 0.672 -9.273" rotation="0,  90, 0"></a-entity>
        <a-entity gltf-model="#spear" scale="1.091 1.091 1.091" position="-9.709 0.672 -10.353" rotation="0,  90, 0"></a-entity>
        <a-entity gltf-model="#spear" scale="1.091 1.091 1.091" position="-9.709 0.672 -11.502" rotation="0,  90, 0"></a-entity>
        <a-entity gltf-model="#spear" scale="1.091 1.091 1.091" position="-9.709 0.672 -12.459" rotation="0,  90, 0"></a-entity>

        <a-entity gltf-model="#mace" scale=".5 .5 .5" position="-9.709 0.672 -14.834" rotation="0,  90, 0"></a-entity>
        <a-entity gltf-model="#mace" scale=".5 .5 .5" position="-9.709 0.672 -16.031" rotation="0,  90, 0"></a-entity>
        <a-entity gltf-model="#mace" scale=".5 .5 .5" position="-9.709 0.672 -17.205" rotation="0,  90, 0"></a-entity>
        <a-entity gltf-model="#mace" scale=".5 .5 .5" position="-9.709 0.672 -18.215" rotation="0,  90, 0"></a-entity>
        <a-entity gltf-model="#mace" scale=".5 .5 .5" position="-9.709 0.672 -19.348" rotation="0,  90, 0"></a-entity>

        <a-entity gltf-model="#bow" scale="0.544 0.427 0.544" position="0 -1.234 -17.310" rotation="-30,  0, 0"></a-entity>
        <a-entity gltf-model="#bow" scale="0.544 0.427 0.544" position="-2 -1.234 -17.310" rotation="-30,  0, 0"></a-entity>
        <a-entity gltf-model="#bow" scale="0.544 0.427 0.544" position="-4 -1.234 -17.310" rotation="-30,  0, 0"></a-entity>
        <a-entity gltf-model="#bow" scale="0.544 0.427 0.544" position="-6 -1.234 -17.310" rotation="-30,  0, 0"></a-entity>

        <a-entity text="value: Inner Courtyard; align: center; color:#785236;" position="0 4.684 1.762" scale="7 7 1" rotation="0 180 0"></a-entity>

        <!-- Physics -->
        <a-box static-body visible="false" position="1.9 4 3" scale="31 12 0.5"></a-box>
        <a-box static-body visible="false" position="1.9 4 -20" scale="31 12 0.5"></a-box>
        <a-box static-body visible="false" position="-10.7 2.5 -9.5" scale="0.6 16 30"></a-box>
        <a-box static-body visible="false" position="16.3 2.5 -9.5" scale="0.6 16 30"></a-box>
        <a-box static-body visible="false" position="11 1.3 -16.3" scale="7.5 8.8 6.9"></a-box>
        <a-box static-body visible="false" position="14.2 2.3 -11.3" scale="7.5 4.8 0.6"></a-box>
        <a-box static-body visible="false" position="5.9 2.3 -18" scale="0.5 4.8 6.1"></a-box>

        <a-box static-body visible="false" position="-9.8 3 -3.5" scale="1 6 4.3"></a-box>
        <a-box static-body visible="false" position="-9.8 3 -10.5" scale="1 6 4.3"></a-box>
        <a-box static-body visible="false" position="-9.8 3 -17.1" scale="1 6 4.3"></a-box>

    </a-scene>

    <script src="./js/scoreSystem.js"></script>
    <script src="./js/gemItemControl.js"></script>
    <script src="./js/message_08_controller.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        function changeScene(val) {
            if (val == "inner_courtyard") {
                socket.emit('inner_courtyard') //calls server method
            }
        };

        let socket = io();
        //default connect event
        socket.on('connect', function() {
            console.log("connected!");
        });

        socket.on('inner_courtyard', function(data) {
            window.location.replace('innercourtyard') //Call
        });
    </script>
</body>

</html>