<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="https://rawgit.com/rdub80/aframe-gui/master/dist/aframe-gui.min.js"></script>
    <!--GUI Library-->
    <script src="https://unpkg.com/aframe-environment-component@1.1.0/dist/aframe-environment-component.min.js"></script>
    <!--Environment extension-->
    <title>Great Chambers</title>

</head>

<body>
    <a-scene physics="debug: false">

        <a-assets>
            <!-- Images -->
            <img id="gemImage" src="./assets/images/gem.png">
            <img id="kingColors" src="./assets/images/kingColorsGame.png">
            <img id="kingMessage" src="./assets/images/kingMessage_09.png">

            <!-- Models -->
            <a-asset-item id="weaponsRoom" src="./assets/models/GreatHall.glb"></a-asset-item>
            <a-asset-item id="door" src="./assets/models/door.glb"></a-asset-item>
            <a-asset-item id="chandelier" src="./assets/models/Chandelier.glb"></a-asset-item>
            <a-asset-item id="table" src="./assets/models/shortTable.glb"></a-asset-item>
            <a-asset-item id="chair" src="./assets/models/chair.glb"></a-asset-item>
            <a-asset-item id="bed" src="./assets/models/bed.glb"></a-asset-item>
            <a-asset-item id="wall" src="./assets/models/Walls.glb"></a-asset-item>
            <a-asset-item id="candle" src="./assets/models/candle.glb"></a-asset-item>
            <a-asset-item id="shelf" src="./assets/models/shelf.glb"></a-asset-item>
            <a-asset-item id="paintingSmall01" src="./assets/models/paintingSmall01.glb"></a-asset-item>
            <a-asset-item id="paintingSmall03" src="./assets/models/paintingSmall03.glb"></a-asset-item>
            <a-asset-item id="tapestry" src="./assets/models/shortTapestry.glb"></a-asset-item>

        </a-assets>

        <a-entity id="cameraRig" player_position location movement-controls kinematic-body>
            <a-entity camera look-controls position="0 2.8 0">
                <a-cursor></a-cursor>

                <a-gui-label id="playerLocation" width="1.5" height="0.3" font-size="4rem" padding="1rem 2rem" position="3 1.8 -2.5" value="Great Chambers">
                </a-gui-label>

                <a-entity visible="false" id="kingMessage_09" position="-2.2 -0.5 -2.5">
                    <a-image src="#kingMessage" width="4" height=" 1.3"></a-image>
                </a-entity>

                <a-image class="gem" id="gem1" src="#gemImage" width="0.3" height="0.5" position="-3.5 1.8 -2.5" opacity="0.4"></a-image>
                <a-image class="gem" id="gem2" src="#gemImage" width="0.3" height="0.5" position="-3.1 1.8 -2.5" opacity="0.4"></a-image>
                <a-image class="gem" id="gem3" src="#gemImage" width="0.3" height="0.5" position="-2.7 1.8 -2.5" opacity="0.4"></a-image>
                <a-image class="gem" id="gem4" src="#gemImage" width="0.3" height="0.5" position="-2.3 1.8 -2.5" opacity="0.4"></a-image>
                <a-image class="gem" id="gem5" src="#gemImage" width="0.3" height="0.5" position="-1.9 1.8 -2.5" opacity="0.4"></a-image>
                <a-image class="gem" id="gem6" src="#gemImage" width="0.3" height="0.5" position="-1.5 1.8 -2.5" opacity="0.4"></a-image>
            </a-entity>
        </a-entity>

        <!-- Lighting -->
        <a-light type="point" position="-2 3 8"></a-light>
        <a-light type="point" position="-2 3 -16"></a-light>

        <!-- Floor -->
        <a-plane static-body material="color: grey" width="1000" height="1000" rotation="-90 0 0" position="0 -0.01 0"></a-plane>

        <!-- Models -->
        <a-entity gltf-model="#weaponsRoom" scale="1.053 2 1.391" position="0 0 -11.09" rotation="0 90 0"></a-entity>

        <a-entity gltf-model="#wall" scale="3.254 3.254 3.254" position="0 0.059 -6.045" rotation="0 0 0"></a-entity>

        <a-entity onclick="changeScene('upper_corridor')" gltf-model="#door" scale="1.4 1.4 1.4" position="0 0 2.2" rotation="0 180 0"></a-entity>

        <a-entity gltf-model="#chandelier" scale=".3 0.649 .3" position="0 12.192 -7.786" rotation="0, 0, 0"></a-entity>

        <a-entity gltf-model="#bed" scale="0.775 0.775 0.775" position="0 0 -14.736" rotation="0, 0, 0"></a-entity>

        <a-entity gltf-model="#table" scale=".015 .033 .015" position="6.715 0 -18.316" rotation="0, 0, 0"></a-entity>
        <a-entity gltf-model="#table" scale=".015 .033 .015" position="-6.715 0 -18.316" rotation="0, 0, 0"></a-entity>

        <a-entity gltf-model="#candle" scale="0.620 0.620 0.620" position="6.715 2.439 -18.316" rotation="0 0 0"></a-entity>
        <a-entity gltf-model="#candle" scale="0.620 0.620 0.620" position="-6.715 2.439 -18.316" rotation="0 0 0"></a-entity>

        <a-entity gltf-model="#paintingSmall01" scale="1.064 1.064 1.064" position="-8.620 0 -4.702" rotation="0 90 0"></a-entity>
        <a-entity gltf-model="#paintingSmall03" scale="1.064 1.064 1.064" position="8.620 0 -4.702" rotation="0 -90 0"></a-entity>

        <a-entity gltf-model="#tapestry" scale="1.029 1.029 1.029" position="6.715 -6.162 -19.139" rotation="0, 0, 0"></a-entity>
        <a-entity gltf-model="#tapestry" scale="1.029 1.029 1.029" position="-6.715 -6.162 -19.139" rotation="0, 0, 0"></a-entity>

        <a-entity text="value: Upper Corridor; align: center; color:#785236;" position="0 4.684 1.762" scale="7 7 1" rotation="0 180 0"></a-entity>


        <!-- Physics -->
        <a-box static-body visible="false" position="6.7 3 -18.3" scale="2 6 2"></a-box>
        <a-box static-body visible="false" position="-6.7 3 -18.3" scale="2 6 2"></a-box>
        <a-box static-body visible="false" position="0 3.2 -15.2" scale="6.8 7.1 9"></a-box>
        <a-box static-body visible="false" position="0 4.5 3" scale="19.2 10 0.7"></a-box>
        <a-box static-body visible="false" position="-9.1 5.3 -10" scale="0.5 13 26"></a-box>
        <a-box static-body visible="false" position="9.1 5.3 10" scale="0.5 13 26"></a-box>
    </a-scene>

    <script src="./js/gemItemControl.js"></script>
    <script src="./js/scoreSystem.js"></script>
    <script src="./js/message_09_controller.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        function changeScene(val) {
            if (val == 'upper_corridor') {
                socket.emit('upper_corridor') //calls server method
            }
        };

        let socket = io();
        //default connect event
        socket.on('connect', function() {
            console.log("connected!");
        });

        socket.on('upper_corridor', function(data) {
            window.location.replace('uppercorridor') //Call
        });
    </script>
</body>

</html>